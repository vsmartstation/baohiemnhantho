<!-- CHATBOT CHUY√äN BI·ªÜT CHO T√ÄI X·∫æ C√îNG NGH·ªÜ -->
<!-- 3-TIER AI: DeepSeek ‚Üí Anthropic ‚Üí Gemini -->
<!-- TRACKING & DATA COLLECTION FOR DRIVERS -->

<style>
/* Enhanced styling for driver-focused chatbot */
.bh-chat-button {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 65px;
    height: 65px;
    background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 8px 32px rgba(255, 107, 53, 0.4);
    z-index: 9999;
    color: white;
    border: none;
    transition: all 0.3s ease;
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% { box-shadow: 0 8px 32px rgba(255, 107, 53, 0.4); }
    50% { box-shadow: 0 8px 32px rgba(255, 107, 53, 0.8); }
    100% { box-shadow: 0 8px 32px rgba(255, 107, 53, 0.4); }
}

.bh-chat-button:hover {
    transform: scale(1.1);
    background: linear-gradient(135deg, #f7931e 0%, #ff6b35 100%);
}

.bh-chat-widget {
    position: fixed;
    bottom: 95px;
    right: 20px;
    width: 400px;
    height: 550px;
    background: white;
    border-radius: 20px;
    box-shadow: 0 25px 70px rgba(0, 0, 0, 0.2);
    display: none;
    flex-direction: column;
    z-index: 10000;
    overflow: hidden;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    border: 3px solid #ff6b35;
}

.bh-chat-widget.open { display: flex; }

.bh-chat-header {
    background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
    color: white;
    padding: 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.bh-chat-header h3 {
    margin: 0;
    font-size: 18px;
    font-weight: 600;
}

.bh-chat-header p {
    margin: 0;
    font-size: 13px;
    opacity: 0.9;
}

.bh-chat-messages {
    flex: 1;
    padding: 20px;
    overflow-y: auto;
    background: linear-gradient(to bottom, #f8fafc 0%, #e2e8f0 100%);
}

.bh-message {
    margin-bottom: 16px;
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.bh-bot-message {
    text-align: left;
}

.bh-bot-message p {
    background: white;
    padding: 12px 16px;
    border-radius: 18px 18px 18px 4px;
    margin: 0;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    border-left: 4px solid #ff6b35;
}

.bh-user-message {
    text-align: right;
}

.bh-user-message p {
    background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
    color: white;
    padding: 12px 16px;
    border-radius: 18px 18px 4px 18px;
    margin: 0;
    display: inline-block;
    max-width: 80%;
}

.bh-quick-questions {
    padding: 15px 20px;
    background: white;
    border-top: 1px solid #e2e8f0;
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.bh-quick-question {
    background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 20px;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
    flex: 1;
    min-width: 120px;
}

.bh-quick-question:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(255, 107, 53, 0.3);
}

.bh-chat-input-area {
    padding: 20px;
    background: white;
    border-top: 1px solid #e2e8f0;
    display: flex;
    gap: 10px;
    align-items: center;
}

.bh-chat-input {
    flex: 1;
    padding: 12px 16px;
    border: 2px solid #e2e8f0;
    border-radius: 25px;
    outline: none;
    font-size: 14px;
    transition: border-color 0.2s ease;
}

.bh-chat-input:focus {
    border-color: #ff6b35;
}

.bh-chat-send {
    background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
    color: white;
    border: none;
    width: 45px;
    height: 45px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
}

.bh-chat-send:hover {
    transform: scale(1.1);
}

.bh-typing-indicator {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 12px 16px;
    background: white;
    border-radius: 18px 18px 18px 4px;
    border-left: 4px solid #ff6b35;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.bh-typing-dot {
    width: 8px;
    height: 8px;
    background: #ff6b35;
    border-radius: 50%;
    animation: typing 1.4s infinite ease-in-out;
}

.bh-typing-dot:nth-child(1) { animation-delay: -0.32s; }
.bh-typing-dot:nth-child(2) { animation-delay: -0.16s; }

@keyframes typing {
    0%, 80%, 100% { transform: scale(0); opacity: 0.5; }
    40% { transform: scale(1); opacity: 1; }
}

.bh-driver-badge {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: white;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 11px;
    font-weight: 600;
    margin-left: 8px;
}

/* Mobile responsive */
@media (max-width: 480px) {
    .bh-chat-widget {
        width: calc(100vw - 40px);
        height: calc(100vh - 140px);
        bottom: 95px;
        right: 20px;
        left: 20px;
    }
}
</style>

<!-- HTML Structure -->
<div id="bh-chat-button" class="bh-chat-button">
    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" stroke="currentColor" stroke-width="2"/>
        <path d="M8 10h8M8 14h4" stroke="currentColor" stroke-width="2"/>
    </svg>
</div>

<div id="bh-chat-widget" class="bh-chat-widget">
    <div class="bh-chat-header">
        <div>
            <h3>T∆∞ V·∫•n B·∫£o Hi·ªÉm T√†i X·∫ø <span class="bh-driver-badge">CHUY√äN BI·ªÜT</span></h3>
            <p>AI mi·ªÖn ph√≠ ‚Ä¢ Kh√¥ng b√°n h√†ng ‚Ä¢ Hi·ªÉu t√†i x·∫ø</p>
        </div>
        <button id="bh-chat-close" style="background: none; border: none; color: white; cursor: pointer; padding: 8px; font-size: 18px;">‚úï</button>
    </div>

    <div id="bh-chat-messages" class="bh-chat-messages">
        <div class="bh-message bh-bot-message">
            <p><strong>Xin ch√†o anh/ch·ªã t√†i x·∫ø!</strong> üèçÔ∏è</p>
            <p>T√¥i l√† tr·ª£ l√Ω AI chuy√™n t∆∞ v·∫•n b·∫£o hi·ªÉm cho <strong>t√†i x·∫ø c√¥ng ngh·ªá</strong> (Grab, Be, Gojek...).</p>
            <p>T√¥i hi·ªÉu nh·ªØng r·ªßi ro v√† kh√≥ khƒÉn c·ªßa anh ch·ªã khi ch·∫°y xe ki·∫øm s·ªëng h√†ng ng√†y.</p>
            <p><em>üéØ Ch·ªâ t∆∞ v·∫•n, kh√¥ng b√°n h√†ng. Ho√†n to√†n mi·ªÖn ph√≠!</em></p>
        </div>
    </div>

    <div class="bh-quick-questions">
        <button class="bh-quick-question" onclick="bhSendMessage('B·∫£o hi·ªÉm tai n·∫°n cho t√†i x·∫ø Grab')">üö® B·∫£o hi·ªÉm tai n·∫°n</button>
        <button class="bh-quick-question" onclick="bhSendMessage('B·∫£o hi·ªÉm y t·∫ø khi kh√¥ng c√≥ BHXH')">üè• B·∫£o hi·ªÉm y t·∫ø</button>
        <button class="bh-quick-question" onclick="bhSendMessage('B·∫£o hi·ªÉm thu nh·∫≠p khi ·ªëm ƒëau')">üí∞ B·∫£o hi·ªÉm thu nh·∫≠p</button>
        <button class="bh-quick-question" onclick="bhSendMessage('So s√°nh c√°c g√≥i b·∫£o hi·ªÉm cho t√†i x·∫ø')">üìä So s√°nh g√≥i BH</button>
    </div>

    <div class="bh-chat-input-area">
        <input type="text" id="bh-chat-input" class="bh-chat-input" placeholder="H·ªèi v·ªÅ b·∫£o hi·ªÉm cho t√†i x·∫ø...">
        <button id="bh-chat-send" class="bh-chat-send">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z" stroke="currentColor" stroke-width="2"/>
            </svg>
        </button>
    </div>
</div>

<script>
// DRIVER-SPECIALIZED CHATBOT WITH 3-TIER AI SYSTEM
(function() {
    // DOM Elements
    const chatButton = document.getElementById('bh-chat-button');
    const chatWidget = document.getElementById('bh-chat-widget');
    const chatClose = document.getElementById('bh-chat-close');
    const chatMessages = document.getElementById('bh-chat-messages');
    const chatInput = document.getElementById('bh-chat-input');
    const chatSend = document.getElementById('bh-chat-send');
    
    // State Management
    let isOpen = false;
    let conversationCount = 0;
    let driverProfile = JSON.parse(localStorage.getItem('driver_profile') || '{}');
    let conversationHistory = [];
    let frustrationLevel = 0;
    
    // API Configuration - 3-Tier System
    const APIs = {
        deepseek: {
            key: 'sk-bd5f9415d5af4666a74b881485528474',
            url: 'https://api.deepseek.com/v1/chat/completions'
        },
        anthropic: {
            key: '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',
            url: 'https://api.anthropic.com/v1/messages'
        },
        gemini: {
            key: 'AIzaSyBxBc7GR97K2Ycu_PHq-JwxVZkX051BZdU',
            url: 'https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent'
        }
    };

    // Driver Detection & Classification
    const driverKeywords = [
        'grab', 'gojek', 'be', 't√†i x·∫ø', 'ch·∫°y xe', 'xe √¥m', 'shipper', 
        'delivery', 'giao h√†ng', 'ch·∫°y grab', 'l√°i xe', 'ki·∫øm ti·ªÅn',
        'uber', 'fastgo', 'vato', 'now', 'baemin', 'shopee food'
    ];

    const frustrationKeywords = [
        'b·ª±c', 't·ª©c', 'kh√¥ng hi·ªÉu', 'ph·ª©c t·∫°p', 'kh√≥ hi·ªÉu', 'r·ªëi', 
        'ch√°n', 'th√¥i', 'm·ªát', 'kh√≥ qu√°', 'kh√¥ng r√µ', 'l·∫±ng nh·∫±ng'
    ];

    // Specialized Driver Prompts
    const driverSystemPrompt = `B·∫°n l√† chuy√™n gia t∆∞ v·∫•n b·∫£o hi·ªÉm chuy√™n bi·ªát cho T√ÄI X·∫æ C√îNG NGH·ªÜ (Grab, Be, Gojek...).

HI·ªÇU BI·∫æT V·ªÄ T√ÄI X·∫æ:
- Thu nh·∫≠p 8-15 tri·ªáu/th√°ng, kh√¥ng ·ªïn ƒë·ªãnh
- R·ªßi ro tai n·∫°n cao g·∫•p 3 l·∫ßn ng∆∞·ªùi b√¨nh th∆∞·ªùng  
- Th∆∞·ªùng kh√¥ng c√≥ BHXH, BHYT
- L√† tr·ª• c·ªôt gia ƒë√¨nh, √°p l·ª±c kinh t·∫ø cao
- L√†m vi·ªác 10-14h/ng√†y, stress cao

NGUY√äN T·∫ÆC T∆Ø V·∫§N:
1. KH√îNG B√ÅN H√ÄNG - ch·ªâ t∆∞ v·∫•n kh√°ch quan
2. Hi·ªÉu ho√†n c·∫£nh kh√≥ khƒÉn c·ªßa t√†i x·∫ø
3. ƒê∆∞a ra l·ªùi khuy√™n th·ª±c t·∫ø, ph√π h·ª£p t√∫i ti·ªÅn
4. ∆Øu ti√™n b·∫£o hi·ªÉm tai n·∫°n v√† y t·∫ø
5. Gi·∫£i th√≠ch ƒë∆°n gi·∫£n, d·ªÖ hi·ªÉu
6. T√≠nh to√°n c·ª• th·ªÉ chi ph√≠ vs l·ª£i √≠ch

LU√îN GHI NH·ªö th√¥ng tin ng∆∞·ªùi d√πng ƒë√£ cung c·∫•p trong cu·ªôc tr√≤ chuy·ªán.
D·∫™N D·∫ÆT cu·ªôc tr√≤ chuy·ªán: Thu th·∫≠p th√¥ng tin ‚Üí Ph√¢n t√≠ch ‚Üí T∆∞ v·∫•n c·ª• th·ªÉ.`;

    // Utility Functions
    function detectDriver(message) {
        return driverKeywords.some(keyword => 
            message.toLowerCase().includes(keyword)
        );
    }

    function detectFrustration(message) {
        const hasFrustrationWords = frustrationKeywords.some(keyword => 
            message.toLowerCase().includes(keyword)
        );
        
        if (hasFrustrationWords) {
            frustrationLevel++;
        }
        
        return hasFrustrationWords || frustrationLevel >= 2;
    }

    function shouldUseAdvancedAI() {
        return conversationCount >= 5 || frustrationLevel >= 2 || 
               conversationHistory.some(msg => msg.includes('kh√¥ng hi·ªÉu') || msg.includes('ph·ª©c t·∫°p'));
    }

    // Chat Functions
    function toggleChat() {
        isOpen = !isOpen;
        chatWidget.classList.toggle('open', isOpen);
        
        if (isOpen) {
            chatInput.focus();
            trackEvent('chat_opened', { driver_detected: Object.keys(driverProfile).length > 0 });
        }
    }

    function addMessage(text, isUser = false) {
        const messageDiv = document.createElement('div');
        messageDiv.className = `bh-message ${isUser ? 'bh-user-message' : 'bh-bot-message'}`;
        messageDiv.innerHTML = `<p>${text}</p>`;
        chatMessages.appendChild(messageDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function showTypingIndicator() {
        const typingDiv = document.createElement('div');
        typingDiv.className = 'bh-message bh-bot-message';
        typingDiv.id = 'typing-indicator';
        typingDiv.innerHTML = `
            <div class="bh-typing-indicator">
                <div class="bh-typing-dot"></div>
                <div class="bh-typing-dot"></div>
                <div class="bh-typing-dot"></div>
            </div>
        `;
        chatMessages.appendChild(typingDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // Progressive Data Collection
    function collectDriverData(message) {
        // Detect platform
        if (message.includes('grab')) driverProfile.platform = 'grab';
        else if (message.includes('be')) driverProfile.platform = 'be';
        else if (message.includes('gojek')) driverProfile.platform = 'gojek';
        
        // Detect vehicle type
        if (message.includes('xe m√°y') || message.includes('motor')) driverProfile.vehicle = 'xe_may';
        else if (message.includes('√¥ t√¥') || message.includes('car')) driverProfile.vehicle = 'oto';
        
        // Save profile
        localStorage.setItem('driver_profile', JSON.stringify(driverProfile));
        
        // Track insights
        trackDriverInsights();
    }

    function askProgressiveQuestions() {
        if (conversationCount === 3 && !driverProfile.age_range) {
            setTimeout(() => {
                addMessage("ƒê·ªÉ t∆∞ v·∫•n ch√≠nh x√°c h∆°n, anh/ch·ªã thu·ªôc ƒë·ªô tu·ªïi n√†o? (20-30, 30-40, 40-50, 50+)");
            }, 1000);
        }
        
        if (conversationCount === 5 && !driverProfile.family_status) {
            setTimeout(() => {
                addMessage("Anh/ch·ªã ƒëang ƒë·ªôc th√¢n hay ƒë√£ c√≥ gia ƒë√¨nh? (ƒë·ªÉ t∆∞ v·∫•n m·ª©c b·∫£o hi·ªÉm ph√π h·ª£p)");
            }, 1000);
        }
        
        if (conversationCount === 7 && !driverProfile.income_range) {
            setTimeout(() => {
                addMessage("Thu nh·∫≠p trung b√¨nh c·ªßa anh/ch·ªã kho·∫£ng bao nhi√™u/th√°ng? (8-12tr, 12-15tr, 15tr+) - ƒë·ªÉ t√≠nh g√≥i b·∫£o hi·ªÉm ph√π h·ª£p");
            }, 1000);
        }
    }

    // API Calls - 3-Tier System
    async function callDeepSeekAPI(message, context) {
        const response = await fetch(APIs.deepseek.url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${APIs.deepseek.key}`
            },
            body: JSON.stringify({
                model: 'deepseek-chat',
                messages: [
                    { role: 'system', content: driverSystemPrompt },
                    { role: 'user', content: `${context}\n\nC√¢u h·ªèi: ${message}` }
                ],
                temperature: 0.7,
                max_tokens: 1000
            })
        });
        
        const data = await response.json();
        return data.choices?.[0]?.message?.content;
    }

    async function callAnthropicAPI(message, context) {
        const response = await fetch(APIs.anthropic.url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${APIs.anthropic.key}`,
                'anthropic-version': '2023-06-01'
            },
            body: JSON.stringify({
                model: 'claude-3-sonnet-20240229',
                max_tokens: 1000,
                messages: [
                    { 
                        role: 'user', 
                        content: `${driverSystemPrompt}\n\nNg∆∞·ªùi d√πng c√≥ v·∫ª b·ª±c m√¨nh ho·∫∑c kh√¥ng hi·ªÉu. H√£y tr·∫£ l·ªùi TH·∫¨T KI√äN NH·∫™N, D·ªÑ HI·ªÇU v√† TH·∫§U C·∫¢M.\n\nContext: ${context}\n\nC√¢u h·ªèi: ${message}` 
                    }
                ]
            })
        });
        
        const data = await response.json();
        return data.content?.[0]?.text;
    }

    async function callGeminiAPI(message, context) {
        const response = await fetch(`${APIs.gemini.url}?key=${APIs.gemini.key}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                contents: [{
                    parts: [{
                        text: `${driverSystemPrompt}\n\nContext: ${context}\n\nC√¢u h·ªèi: ${message}`
                    }]
                }]
            })
        });
        
        const data = await response.json();
        return data.candidates?.[0]?.content?.parts?.[0]?.text;
    }

    // Main Send Message Function
    async function sendMessage(message) {
        if (!message.trim()) return;
        
        // Add user message
        addMessage(message, true);
        chatInput.value = '';
        conversationCount++;
        conversationHistory.push(message);
        
        // Collect driver data
        if (detectDriver(message)) {
            collectDriverData(message);
        }
        
        // Show typing indicator
        showTypingIndicator();
        
        try {
            // Build context
            const context = `
Th√¥ng tin t√†i x·∫ø: ${JSON.stringify(driverProfile)}
L·ªãch s·ª≠ tr√≤ chuy·ªán: ${conversationHistory.slice(-3).join(' | ')}
S·ªë l∆∞·ª£t h·ªèi: ${conversationCount}
            `;
            
            let response;
            
            // Choose AI tier based on situation
            if (detectFrustration(message) || shouldUseAdvancedAI()) {
                console.log('Using Anthropic for complex/frustrated user');
                response = await callAnthropicAPI(message, context);
                trackEvent('ai_tier_used', { tier: 'anthropic', reason: 'frustration_or_complex' });
            } else {
                try {
                    response = await callDeepSeekAPI(message, context);
                    trackEvent('ai_tier_used', { tier: 'deepseek', reason: 'normal' });
                } catch (error) {
                    console.log('DeepSeek failed, falling back to Gemini');
                    response = await callGeminiAPI(message, context);
                    trackEvent('ai_tier_used', { tier: 'gemini', reason: 'deepseek_fallback' });
                }
            }
            
            // Remove typing indicator
            document.getElementById('typing-indicator')?.remove();
            
            if (response) {
                addMessage(response.replace(/\n/g, '<br>'));
                
                // Ask progressive questions
                askProgressiveQuestions();
                
                // Track successful interaction
                trackEvent('message_success', {
                    conversation_count: conversationCount,
                    driver_profile_completeness: Object.keys(driverProfile).length
                });
            } else {
                addMessage('Xin l·ªói anh/ch·ªã, t√¥i kh√¥ng th·ªÉ tr·∫£ l·ªùi l√∫c n√†y. Vui l√≤ng th·ª≠ l·∫°i sau ho·∫∑c h·ªèi c√¢u kh√°c.');
            }
            
        } catch (error) {
            document.getElementById('typing-indicator')?.remove();
            addMessage('Xin l·ªói, c√≥ l·ªói k·∫øt n·ªëi. Anh/ch·ªã th·ª≠ h·ªèi l·∫°i sau nh√©!');
            console.error('API Error:', error);
            
            trackEvent('message_error', { error: error.message });
        }
    }

    // Analytics & Tracking
    function trackEvent(eventName, data) {
        // Google Analytics 4
        if (typeof gtag !== 'undefined') {
            gtag('event', eventName, {
                custom_parameter_1: data.tier || 'unknown',
                custom_parameter_2: data.conversation_count || 0,
                custom_parameter_3: data.driver_profile_completeness || 0,
                custom_parameter_4: data.reason || 'unknown'
            });
        }
        
        // Console log for debugging
        console.log('Event tracked:', eventName, data);
        
        // Store in localStorage for analysis
        const events = JSON.parse(localStorage.getItem('bh_events') || '[]');
        events.push({
            event: eventName,
            data: data,
            timestamp: new Date().toISOString()
        });
        localStorage.setItem('bh_events', JSON.stringify(events.slice(-50))); // Keep last 50 events
    }

    function trackDriverInsights() {
        const insights = {
            platform: driverProfile.platform,
            vehicle: driverProfile.vehicle,
            age_range: driverProfile.age_range,
            family_status: driverProfile.family_status,
            income_range: driverProfile.income_range,
            conversation_count: conversationCount,
            session_duration: Date.now() - sessionStart
        };
        
        trackEvent('driver_insights', insights);
    }

    // Global function for quick questions
    window.bhSendMessage = sendMessage;

    // Event Listeners
    chatButton.addEventListener('click', toggleChat);
    chatClose.addEventListener('click', toggleChat);
    
    chatSend.addEventListener('click', () => {
        sendMessage(chatInput.value);
    });
    
    chatInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            sendMessage(chatInput.value);
        }
    });
    
    // Close chat when clicking outside
    document.addEventListener('click', (e) => {
        if (isOpen && !chatWidget.contains(e.target) && !chatButton.contains(e.target)) {
            toggleChat();
        }
    });

    // Session tracking
    const sessionStart = Date.now();
    
    // Initialize
    console.log('Driver-specialized chatbot initialized');
    trackEvent('chatbot_loaded', { 
        existing_profile: Object.keys(driverProfile).length > 0,
        timestamp: new Date().toISOString()
    });
})();
</script>

<!-- Google Analytics 4 Integration (Optional) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'GA_MEASUREMENT_ID'); // Replace with your GA4 ID
</script>

